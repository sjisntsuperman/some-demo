# 弹幕实现

先说下整体思路把。

1. 创建video标签，给定固定的宽高
2. 创建barrage实体类，并定制内部的事件，比如说渲染字幕，通过canvas实现的话，是需要调用canvas的api，很简单
3. 注意，整个画布的大小是要跟video的大小是相同的
4. 弹幕移动的话，是需要每次减去speed的x坐标，就可以实现移动的效果
5. 弹幕通道是通过上次弹幕的距离计算出来的，并从上到下发布
6. 说下一些边界处理，超出画布高度，就调整弹幕的y坐标，另外处理
7. 当有新弹幕输入，应该要加入栈，然后计算初始坐标
8. 整个数据结构应该是应该是一个队列的形式，不断移出队列，把新的元素添加入队列
9. 分为css和canvas两种实现方式，这里选用的是canvas，注意requestAnimation的调用
10. 暂停和清空的处理，弹幕实体类应该加入一个clear的方法清空画布
11. 颜色应当是要另外计算，默认是黑色，然后根据后台返回用户选择的字体颜色进行渲染，很简单
12. barrage实体类应当有一个销毁的钩子，用来表明下次不会再利用，直接GC掉

设计好后，就得想如何具体实现。

迟点回来再整理一下，直接实现吧。

方法还是从简单，到复杂。

## 分阶段实现

- 匀速
- 变速

- 轨道算法
- 找空位

## 可能会用到的公式

### 追击问题

<!-- 求 -->

<!-- Sx=Sy+K -->
